<div class="profile-container">
  <header class="profile-header">
    <div class="profile-avatar">
      <div class="avatar-placeholder"></div>
    </div>

    <section class="profile-info">
      <div class="profile-top-row d-flex align-items-center gap-3">
        <h1 class="m-0"><%= @profile.username %></h1>
        <% if current_account == @profile.account %>
          <%= link_to "Edit Profile", edit_profile_path, class: "btn btn-outline-secondary btn-sm" %>
        <% end %>
      </div>

      <ul class="profile-stats">
        <li><strong><%= @posts.count %></strong> posts</li>
        <li>
          <%= link_to followers_account_path(@profile.account), class: "text-decoration-none text-dark" do %>
            <strong><%= @profile.account.followers.count %></strong> followers
          <% end %>
        </li>
        <li>
          <%= link_to following_account_path(@profile.account), class: "text-decoration-none text-dark" do %>
            <strong><%= @profile.account.following.count %></strong> following
          <% end %>
        </li>
      </ul>

      <div class="profile-bio">
        <p class="full-name"><%= @profile.display_name %></p>
        <p><%= @profile.bio %></p>
      </div>
    </section>
  </header>

  <hr class="separator">

  <div class="posts-grid">
  <% # Important fix: use the loop variable 'post' %>
    <% @posts.each do |post| %>
      <div class="post-item">
        <%= link_to post_path(post), class: "post-link" do %>
          <div class="post-overlay">
            <span>‚ù§Ô∏è <%= post.reactions.count %></span>
          </div>
          <div class="post-placeholder">
            <% if post.media_assets.any? %>
              <span class="carousel-icon">üìÅ</span>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>